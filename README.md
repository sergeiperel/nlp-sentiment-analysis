## Анализ тональности и внутренней структуры твитов

### Описание проекта
Социальные сети являются неотъемлемой частью жизни многих людей. X (бывш. - Twitter) - одна из самых популярных платформ, где каждый может общаться друг с другом, обмениваясь информацией и мнениями. Илон Маск - один из самых известных предпринимателей и инноваторов в мире. Его твиты могут оказывать влияние финансовые рынки, в частности,в отношении акций компаний, с которыми он связан (например, Tesla и SpaceX). Изучение тональности постов Маска может дать представление о том, как общество воспринимает идеи и инициативы Илона Маска, а также о том, как он реагирует на общественные настроения.

В репозитории хранятся ноутбуки:
- `scraping.ipynb`: несмотря на то, что из-за ограничений на скрепинг в Твиттере (можно просматривать не более 500 твитов в день) мы решили использовать уже собранные данные с Kaggle, наш датасет можно дополнять новыми данными, которые собираются в том же формате в данном ноутбуке
- `labeling.ipynb`: собранные данные мы размечаем с помощью предобученных моделей 
- `eda_elon_musk.ipynb`: EDA и предварительная обработка данных. Также только предобработку отдельно от EDA можно найти в ноутбуке `preprocessing.ipynb`
- `model.ipynb`: эксперименты с задачей классификации на наших данных

### Выводы по EDA:
1. выборка содержит 5 904 наблюдений за июнь 2022-июль 2023 гг., пропущенных значений и дубликатов нет;
2. наибольшее количество твитов Илон Маск пишет поздним днём и вечером;
3. в 2023 г. Илон Маск стал публиковать больше твитов, чем в 2022 г.;
4. большинство твитов Илона Маска являются позитивными (61,84%);
5. в каждом месяце Илон Маск пишет больше твитов положительной, а не негативной тональности. При этом в 2023 году Маск стал писать больше негативных твитов по сравнению с 2022 годом;
6. наиболее используемые знаки препинания в твитах - точка, восклицательный и вопросительный знаки вне зависимости от тональности;
7. большее число знаков препинания характерно для твитов положительной тональности;
8. большее число электронных адресов, никнеймов, ссылок и эмодзи присуще позитивным твитам;
10. длина твитов негативной тональности превышает длину твитов позитивной тональности;
11. существительные, глаголы и прилагательные - самые употребляемые части речи в твитах как позитивной, так и негативной тональности;
12. самые популярные слова в позитивных твитах - twitter, good, great, true, exactly и пр., в негативных твитах - twitter, people, account, would, like и пр.;
13. наиболее часто встречаемые биграммы в позитивных твитах - next week, good question, coming soon, в негативных твитах - major problem, free speech, look like;
14. наиболее часто встречаемые триграммы в позитивных твитах - entertaining outcome likely, make life multiplanetary, feel long ago, в негативных твитах - new york time, woke mind virus, medium clickseeking machine.

### Клиент-серверное приложение
### Функционал
- Работа с обработанным датасетом твитов Илона Маска
- Загрузка датасета и выдача статистики по нему
- Выбор из трёх моделей:
  - логистическая регрессия;
  - дерево решений;
  - метод ближайших соседей.
- Эксперименты с обучением моделей с настройкой гиперпараметров
- Интерактивные кривые обучения для эксперимента
- Инференс на новых данных

### Установка и запуск (docker-compose.yml)
```commandline
sudo docker compose build
docker compose up -d
```
Сервер доступен на порту 8321.
Клиент - на 8501.

### Описание API

Данный API предоставляет функционал для работы с моделями машинного обучения. Он включает в себя методы для установки активной модели, тренировки модели, получения списка доступных моделей и выполнения предсказаний. Ниже представлено описание каждого из доступных методов API:

1. Установка модели
- Метод: POST
- Эндпоинт: /set/{model_id}
- Параметры:
- model_id (int): идентификатор модели, которую необходимо сделать активной
- Ответ: ModelListResponseItem
  - id (int): идентификатор установленной модели
  - model_type (str): тип модели
  - description (str): описание модели
- Ошибки:
  - 422: если модель с указанным model_id не найдена

2. Тренировка модели
- Метод: POST
- Эндпоинт: /fit
- Тело запроса: FitRequestItem
  - X_train (List[List[float]]): тренировочные данные
  - y_train (List[float]): метки тренировочных данных
  - hyperparameters (Dict[str, Any]): гиперпараметры для настройки модели
  - val_dataset (ValDataset | None): валидационный набор данных
- Ответ: FitResponseItem
  - auc_roc (float): Значение AUC-ROC на тренировочных данных
  - tpr_train (List[float]): True Positive Rate на тренировочных данных
  - fpr_train (List[float]): False Positive Rate на тренировочных данных
  - auc_roc_val (float | None): Значение AUC-ROC на валидационных данных (если предоставлены)
  - tpr_val (List[float] | None): True Positive Rate на валидационных данных
  - fpr_val (List[float] | None): False Positive Rate на валидационных данных
- Ошибки:
  - 422: если активная модель не установлена или обучение заняло слишком много времени

4. Получение списка моделей
- Метод: GET
- Эндпоинт: /models
- Ответ: List[ModelListResponseItem] Список моделей, каждая из которых содержит:
- id (int): идентификатор модели
- model_type (str): тип модели
- description (str): описание модели

5. Предсказание
- Метод: POST
- Эндпоинт: /predict
- Тело запроса: PredictRequest
  - X (List[List[float]]): данные для предсказания
- Ответ: PredictionResponseItem
  - predict (List[int]): предсказанные значения
  - predict_prob (List[float]): вероятности предсказания для каждого класса
- Ошибки:
  - 422: если активная модель не установлена

**Дополнительно**
- Обработчики ошибок: если модель не установлена или происходят ошибки во время тренировки или предсказания, API возвращает ошибку с кодом 422 и соответствующим сообщением.

## Инструкция пользователя (клиент)

1. Откройте браузер по адресу: http://localhost:8501/
2. Загрузите датсет (файл elon_musk_tweets_after_eda.csv)
При загрузки автоматически определятся параметры датасета
3. Нажмите на кнопку "List models", чтобы получить список моделей на сервере
При выборе модели откроется список с гиперпараметрами доступными для модели
4. После настройки гиперпараметров установите размер валидационной выборки и запустите тренировку кнопкой "Run"
5. Если обучение прошло успешно отобразится интерактивная кривая ROC-AUC для обучающей и валидационной выборки
6. Так же можно загрузить данные и провести инференс натренерованной модели

### Участники проекта
- Неволина Арина (@nevolinaa) - куратор проекта
- Перелыгин Сергей (@sergeiperel)
- Каменчук Николай (@Luckymannn)
- Ларин Дмитрий (@FromTtoT)
- Копчев Владислав (@aefrt)
- Шарова Елизавета (@lisaandreevna)

